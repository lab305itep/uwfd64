#!/bin/bash
N=${1-4}
GA=${2-2}

# load and init, clear inhibit
./uwfdtool "p $N main.bin; i $N;m $N 0"
# program adc's for normal operation
./uwfdtool "r $N 0 0xD=0;r $N 1 0xD=0;r $N 2 0xD=0;r $N 3 0xD=0;r $N 4 0xD=0;r $N 5 0xD=0;r $N 6 0xD=0;r $N 7 0xD=0;r $N 8 0xD=0;r $N 9 0xD=0;r $N 10 0xD=0;r $N 11 0xD=0;r $N 12 0xD=0;r $N 13 0xD=0;r $N 14 0xD=0;r $N 15 0xD=0"
# program slave xilinxes
# set raw mode, winbeg, winlen
./uwfdtool "x $N 1=0x8000;x $N 0x2001=0x8000;x $N 0x4001=0x8000;x $N 0x6001=0x8000;x $N 0x28=0x40;x $N 0x2028=0x40;x $N 0x4028=0x40;x $N 0x6028=0x40;x $N 0x29=0x40;x $N 0x2029=0x40;x $N 0x4029=0x40;x $N 0x6029=0x40"
# leave only one channel active
#./uwfdtool "x $N 0x21=0xFFFE;x $N 0x2021=0xFFFF;x $N 0x4021=0xFFFF;x $N 0x6021=0xFFFF"
# leave only one Xil active
./uwfdtool "x $N 0x21=0xFFFF;x $N 0x2021=0x0;x $N 0x4021=0xFFFF;x $N 0x6021=0xFFFF"
# all channels active
#./uwfdtool "x $N 0x21=0x0;x $N 0x2021=0x0;x $N 0x4021=0x0;x $N 0x6021=0x0"
# no selftriggers
#./uwfdtool "x $N 0x22=0xFFFF;x $N 0x2022=0xFFFF;x $N 0x4022=0xFFFF;x $N 0x6022=0xFFFF"

